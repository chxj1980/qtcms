<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>settings</title>

<link rel="stylesheet" type="text/css" href="css/play_back.css">
<link rel="stylesheet" href="treeview/jquery.treeview.css" />	

<!-- 语言文件 -->
<script type="text/javascript" src="lang/zh_CN.js"></script>
<script type="text/javascript" src="lang/en_GB.js"></script>
<script type="text/javascript" src="lang/tr_TR.js"></script>
<script type="text/javascript" src="lang/ru_RU.js"></script>
<!-- 语言文件 end -->

<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/qframework.js"></script>
<script type="text/javascript" src="js/public.js"></script>

<style type="text/css">
	#search_result{background: #1E1E1E; position: absolute; top: 78px;}
	#file_bottom{ line-height: 22px; height: 30px; background: url(./images/backup/backup_table_bg.png) repeat-x 0 -16px; font-size: 14px; position: absolute;}
	#file_bottom a{display: block; height: 22px; width: 100px; background: url(./images/backup/botton.png); float: left; margin:6px; background-position: 0 0; text-align: center; color: #B5B5B6;}
	#search_result table { border-collapse:collapse; color: #BEBEBE;width: 100%;display: block; text-align: center;}
	#search_result .thead td{ background:url(images/log/thead_bg.png) repeat-x 0 0; height: 20px;}
	#file_warp tbody td{ border: 1px solid #414141;height: 16px;}
	#search_result .type span{ float: left;}
	#search_result .type{ height: 14px; width:auto;}
	#search_result .type .color{height: 10px; width: 16px; margin: 4px 2px;}

	.switch{ position: relative;}

	.progess div{ width: 250px; border:1px solid #fff; height: 14px; float: left;}
	.progess span{ background: #abcdef; height: 14px; width:0px; display: block;}
	.progess a{height:14px; width: 14px; display: block; background: red; float:left; margin:1px 8px;}
	/* 下载进度 */
	#fileRec{float: right; line-height: 30px; width:auto; margin-right: 26px; display: none;}
	#fileRec *{border: 1px solid #ccc; float: right; height: 12px;}
	#fileRec p{ margin: 9px 0; width: 100px;}
	#fileRec span{ background: #ccc; float: left; width: 50px; height: 10px;}
	#fileRec h5{ border: none; line-height: 32px;}
	#fileRec h4{float: left; border: none;}

	#list .sel li{background-color: #ABCDEF}
	#page span{ cursor: pointer; margin: 8px 2px; text-decoration: underline; line-height: 16px; width: 16px; height: 16px; display: block; float: left;}
	#page span.sel{ color: #F05133}
	.red{color:red;}
</style>
</head>

<body>
<object type="application/cms-common-library" id="commonLibrary" style="position: absolute;width:0; height:0" ></object>
<script type="text/javascript">
	lang = window[document.getElementById('commonLibrary').getLanguage()] || zh_CN;
</script>
<object type="application/cms-remote-playback" id="playback" style="width:100%;height:0px;"></object>
<object type="application/cms-remote-backup" id="backup" style="width:100%;height:0px;"></object>
	<div id="top">
		<div class="top_act">
			<h4><script>T("DVR_client")</script></h4>
			<div id="test" style="float:left;"></div> 	
			<div id="top_window_act">
				<ul>
					<li id="app_close_window"><a class="hover" title="Close" style="background-position: -336px -104px;"></a></li>
					<!-- <li id="app_maxsize"><a class="hover" title="max" style="background-position: -336px -78px;"></a></li> -->
					<li id="app_minsize"><a class="hover" title="min" style="background-position: -336px -52px;"></a></li>
					<!-- <li id="app_userlock"><a class="toggle hover" title="lock"></a></li> -->
				</ul>
			</div>
		</div>
		<div class="top_nav">
			<ul>
				<li><a style="width:36px;"></a><script>T("Preview")</script></li>
				<li><a style="background-position: -36px 0;"></a><script>T("Playback")</script></li>
				<li class="active"><a style="background-position: -62px 0;"></a><script>T("Backup")</script></li>
				<li><a style="background-position: -88px 0; width:36px;"></a><script>T("Set_up")</script></li>
				<!-- <li><a class="hover" style="background-position: 0 -208px;">System</a></li>
				<li><a style="background-position: -124px 0;"></a><script>T("log")</script></li> -->
			</ul>
			<!-- <div>
				<a></a>				
				<p style="color:#000;"><span><script>T("Login_account")</script></span>eddy</p>
			</div> -->
			</div>
		</div>
	</div>
	<div id="search_device">
		<!-- <ul class="switchlist">
			<li class="switchlistAct"><script>T("Area")</script></li>
			<li>Group</li>
		</ul> -->
		<div class="dev_list" id="list">
			<ul class="filetree">			
			</ul>
		</div>
		<div style="height:24px;">
			<table>
				<tr>
					<td style="text-align:right; cursor:default; font-size:14px;"><script>T("File_Type")</script></td>
					<td>
						<div id="type" class="select" style="width:133px;"><input data="15" value="All" /><a class="hover"></a></div>
						<ul class="option">
							<li><input data="15" value="All" /></li>
							<li><input data="1" value="Timing" /><span class="typeColor" style="background:#F00"></span></li>
							<li><input data="2" value="Mobile" /><span class="typeColor" style="background:#33CC00"></span></li>
							<li><input data="4" value="Sensor" /><span class="typeColor" style="background:#FFFF00"></span></li>
							<li><input data="8" value="Manual" /><span class="typeColor" style="background:#0000FF"></span></li>	
						</ul>
					</td>
				</tr>
			</table>	
		</div>
		<div class="calendar">
			<div class="calendar_top">
				<a class="hover" style="background-position: -240px -31px;" title="Prev_year"></a>
				<a class="hover" style="background-position: -160px -31px;" title="Prev_Month"></a>
				<span class="nowDate" title="Current_search_date"></span>
				<a class="hover" style="background-position: -0px -31px;" title="Next_year"></a>
				<a class="hover" style="background-position: -80px -31px;" title="Next_Month"></a></div>
			<div class="calendar_days">
				<table>
					<thead>
						<tr>
						<td style="color:red;"><script>T("Sun")</script></td>
						<td><script>T("Mon")</script></td>
						<td><script>T("Tue")</script></td>
						<td><script>T("Wed")</script></td>
						<td><script>T("Thu")</script></td>
						<td><script>T("Fri")</script></td>
						<td style="color:red;"><script>T("Sat")</script></td>
                        </tr>
                        <tr><td style="color:red;">Sha</td>
						<td style="color:red;">Yek</td>
						<td>Dos</td>
						<td>Ses</td>
						<td>Cha</td>
						<td>Pan</td>
						<td>Jom</td>
                        </tr>
					</thead>
					<tbody>
						<tr><td style="color:red;"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
						<tr><td style="color:red;"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
						<tr><td style="color:red;"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
						<tr><td style="color:red;"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
						<tr><td style="color:red;"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
						<tr><td style="color:red;"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
					</tbody>
				</table>
			</div>
			<div class="hover seek" onclick="backupSearchFile();" title="Start_Search"><script>T("Start_Search")</script></div>
		</div>
	</div>
	<div id="search_result">
			<table class="thead">
				<thead style="border:0; font-size: 14px;">
					<tr>
						<td></td>
						<td><script>T("Device_name")</script></td>
						<td sort="Chl" sorType="1"><script>T("Channel")</script></td>
						<td sort="Type"><script>T("video_type")</script></td>
						<td sort="Time"><script>T("Star_Time")</script></td>
						<td sort="Time"><script>T("End_Time")</script></td>
						<td style="width:300px;"><script>T("Progress")</script></td></tr>
				</thead>
			</table>
			<table id="file_warp" style="overflow-x:hidden; overflow-y:auto; position: relative; top:-4px;">
				<thead>
					<tr>
						<td style="width:50px;"></td>
						<td style="width:160px;"></td>
						<td style="width:50px;"></td>
						<td style="width:140px;"></td>
						<td></td>
						<td></td>
						<td style="width:300px;"></td>
					</tr>
				</thead>
				<tbody class="synCheckboxClick" id="search_resultFile">
					<!-- <tr><td><input type="checkbox" /></td><td>1123123</td><td>1</td><td><span class="type"><span class="hint">定时</span><span class="color" style="background:red"></span></span></td><td>2010-10-10 24:59:59</td><td>2010-10-10 24:59:59</td><td class="progess"><div><span></span></div><a></a></td></tr> -->
				</tbody>
			</table>
	</div>
	<div id="file_bottom">
		<a style="margin-left:30px;" class="hover" onclick="selectAll();"><script>T("Select")</script></a>
		<a class="hover" onclick="backupstop();" id="tableAntiElection"><script>T("Stop_backup")</script></a>
		<a class="hover" onclick="getDir();"><script>T("Start_Backup")</script></a>
		<span id="page"></span>
		<div id="fileRec"><h4><script>T("Retrieving")</script></h4><h5></h5><p><span></span></p></div>
	</div>
	<div id="foot"></div>
    
	<script type="text/javascript" src="js/calendarGJ.js"></script>
    <script type="text/javascript" src="js/gregorian-jalaali.js"></script>
     
<script type="text/javascript" src="treeview/jquery.treeview.js"></script>
<script type="text/javascript" src="treeview/jquery.treeview.edit.js"></script>

<script type="text/javascript" src="js/ocxfunction.js"></script>
<script type="text/javascript">
var oPlayBack={},  // 远程回访控件对象
	oBackup={},    // 备份控件对象
	now = 0,	   // 当前下载的第几个文件
	recFile=[],    // 搜索文件
	usedUid = [],
	nowPage=-1,
	perPageNum=100;

	$(function(){
		oPlayBack = $('#playback')[0];
		oBackup = $('#backup')[0];

		$('tbody.synCheckboxClick').on('click','input:checkbox',function(){
			if(oBackup.getProgress() != 0){
				return;
			}
		})
       
		$('tbody.synCheckboxClick').each(function(){
			$(this).SynchekboxClick();
		})

		//文件排序
		$('#search_result thead:eq(0) td:gt(1)').mousedown(function(){ 
			$(this).css('background-position','0 -20px');
		}).mouseup(function(){ 
			$(this).css('background-position','0 0');
			var type = $(this).attr('sort');
			if(type && recFile){ // 文件排序重画UI
				$('#search_resultFile').html('');
				var sorType='',
					node = $(this);

				if(type == 'Time'){
					node = $(this).parent('tr').find('td[sort="Time"]');
				}
				if($(this).attr('sorType')){
					sorType = 'Des';
					node.removeAttr('sorType');
				}else{
					sorType = 'Asc';
					node.attr('sorType',1);
				}
				reSort_2UI(type+sorType);			
			}
		}).mouseout(function(){
			$(this).css('background-position','0 0');
		})

		initOxcDevListStatus();
         
		 
		oBackup.AddEventProc('RecordDirPath','getDirCallback(data)');  //远程备份获取备份路径
		oBackup.AddEventProc('BackupStatusChange','BackupStatusChangeCallback(data)'); //远程备份下载状态
		oBackup.AddEventProc('progress','progressCallback(data)'); //远程备份下载进度
		
		
			 

		
	})///

	$(window).resize(contentMax);
	
   
	function RecFileInfoCallback(data){
		//console.time('---------------搜索到文件回调---------------');
		
		for ( i in data){
			recFile.push($.parseJSON(data[i]));
		}

		//console.log(recTotal+'//'+recFile.length);

		//if(recTotal==recFile.length)
		var l = $('#page span').length;
		$('<span onclick="selectPage('+l+',this)">'+(l+1)+'</span>').appendTo($('#page'));

		if(nowPage == -1){
			//console.log('-----------第一页--------')
			$('#page span:first').addClass('sel');
			nowPage=0;
			selectPage(nowPage);
		}
		
		showRecProgress((l+1)*100);

		//console.timeEnd('---------------搜索到文件回调---------------');

	}

	function reSort_2UI(sortfn){
		var obj =$('#search_resultFile tr');
		if(obj.length != 0){
			obj.filter(function(){
				return !$(this).find(':checkbox').is(':checked');
			}).remove();//远程备份中正在下载的文件不被删除.

			obj.has(':checked').each(function(){
				usedUid.push($(this).attr('uid'));
			})
		}
		var fn = window[sortfn],
			start = nowPage*perPageNum;
			nowPageFile = recFile.slice(start,(start+perPageNum+1)).sort(fn);
		//console.log('----------文件重绘第:'+nowPage+'页-'+start+'到'+(start+perPageNum+1)+'------');
		//console.log(nowPageFile);
		RecFile2UI(nowPageFile);
	}

	function RecFile2UI(nowPageFile){
		/*console.log(nowPageFile);
		console.log(splitBY1Hour(nowPageFile));*/
		nowPageFile = splitBY1Hour(nowPageFile);
		//console.time('+++++++开始绘制搜索到的文件UI+++++++++'+nowPageFile.length);

			
		var sDevName = $('div.dev_list li.sel span.device').data('data').device_name,
			str ='',
			oParent = $('#search_resultFile');
        var bo = document.getElementById('commonLibrary').getLanguage() =='en_PR',
		    isJalaali = document.getElementById('commonLibrary').getIsPersian(),
			isChecked = bo&&isJalaali;
			
		for(var i=0;i<nowPageFile.length;i++){ 
			var b = 1;
			var data = nowPageFile[i];
			var uid = sDevName+'_'+data.channelnum+'_'+data.types+'_'+data.start+'_'+data.end;
			var type =typeHint[data.types];
			var typeColor = color[data.types];
            var start = isChecked ? solar_to_jalaali(data.start.split(' ')[0])+ ' ' + data.start.split(' ')[1] : data.start ;
		    var end = isChecked ? solar_to_jalaali(data.end.split(' ')[0])+ ' ' + data.end.split(' ')[1] : data.end ;
			for(var k=0;k<usedUid.length;k++){
				if(usedUid[k] == uid){
					b=0;
				}
			}
			
			if(b){
				str+='<tr uid="'+uid+'"><td><input type="checkbox" /></td><td>'+sDevName+'</td><td>'+data.channelnum+'</td><td><span class="type"><span class="hint">'+type+'</span><span class="color" style="background:'+typeColor+'"></span></span></td><td>'+start+'</td><td>'+end+'</td><td class="progess"><div><span></span></div><a></a></td></tr>';
			}
		}
		var obj = $(str).appendTo(oParent);

		var warp = $('#file_warp');

		if($('#search_resultFile').height() > warp.height() && !warp.attr('b')){
			theadtbody(warp.find('thead td'),warp.prev('table').find('td'));
			warp.attr('b',0);
		}
		/*console.time('++++++文件列表完成后数据绑定+++++++++');	
		for(var i=0;i<recFile.length;i++){ 
			var data = recFile[i];
			var uid = sDevName+'_'+data.channelnum+'_'+data.start+'_'+data.end;
			//console.log(uid);
			//obj.is('[uid="'+uid+'"]').find(':checkbox').data('data',data);
			obj.each(function(){
				if($(this).attr('uid') == uid){
					$(this).find(':checkbox').data('data',data);
				}
			})
		}
		console.timeEnd('++++++文件列表完成后数据绑定+++++++++');	*/

		//console.timeEnd('+++++++开始绘制搜索到的文件UI+++++++++'+nowPageFile.length);
	}

	function splitBY1Hour(arr){
		var a=[];
		for(var i=0,j=arr.length;i<j;i++){
			
			//console.log(arr[i]);
			if(time2Sec(arr[i].end.split(' ')[1]) - time2Sec(arr[i].start.split(' ')[1]) > 3600){
				/*console.log('当前文件时间大于一小时');
				console.log(arr[i]);*/
				a = a.concat(SPLIT(arr[i]));
			}else{
				a.push(arr[i]);
			}
		}

		return a;

		function SPLIT(obj){
			var date = obj.start.split(' ')[0] || obj.end.split(' ')[0],
				start = obj.start.split(' ')[1],
				end = obj.end.split(' ')[1],
				aa=[],
				st = start;

			for(var j=0;j<24;j++){

				var o = {},

					newed = returnTime(parseInt((time2Sec(st)/3600),10)*3600+3599);

					newed = newed > end ? end : newed;

				//console.log(newed);

				if(newed >= end){
					//console.log(st+'//'+newed+'-----------------'+(newed >= end));
					//console.log(aa);
					return aa;
				}

				o.channelnum = obj.channelnum;
				o.filename = obj.filename;
				o.index = obj.index;
				o.start = date +' '+st;
				o.types = obj.types;
				o.end = date +' '+ newed;
				st = returnTime(parseInt(time2Sec(newed))+1);

				aa.push(o);
			}
		}

	}

	function contentMax(){
		var H = $(window).height();
		var W = $(window).width();
			W = W <=1000 ? 1000 : W;
			H = H <=600 ? 600 : H;
		var main = $('#search_result').css({
			height: H - 138,
			width: W - 238
		});

		$('#file_warp').height(main.height() -18).find('thead td:gt(3)').not(':last').width(($('#file_warp').width()-700)/2);

		theadtbody($('#file_warp thead td'),$('#search_result thead:first td'));

		$('#search_device').css({
			left:main.width()+2
		})
		$('#foot').css({
			top:main.height() + 110
		})
		$('#top').width(main.width()+238);
		$('div.dev_list').height(main.height()-163);
		$('#file_bottom').css({
			width:main.width(),
			top:main.height()+78
		});
	}

	function getDir(){
		if($('#search_resultFile input:checked').length == 0){
			return;
		}
		oBackup.ChooseDir();
	};

	var path = '',
		now = 0,
		timer = null;
	
	function getDirCallback(data){ 
		now = 0;
		path = data.path;
		if(path == '')
			return;

		var oList = $('#search_result tr').find('td.progess span').stop(true,true).css('width',0).end().has(':checked');
		if(!oList.length || oList.length == 0){
			return;
		}

		startDownload();
	}

	function startDownload(){
		/*if(now >= oList.length){
			show('所有选择的文件下载完成!');
			now=0;
			return false;
		}*/
		var oList = $('#search_result tr')/*.find('td.progess span').stop(true,true).css('width',0).end()*/.has(':checked');
		var oDevData = $('div.dev_list li.sel span.device').data('data');
		var fileData = oList.eq(now).attr('uid').split('_');
		/*console.log(fileData);
		console.log('--------选中设备--------')*/
		/*console.log($('div.dev_list li.sel span.device'));
		console.log(oDevData);
		console.log('--------选中通道--------')
		console.log(oList.eq(now));
		console.log(fileData);*/
		console.log('开始下载当前第'+(now+1)+'/'+oList.length+'个文件!-----------设备地址:'+oDevData.address+'--端口--'+oDevData.port+'--易视ID--'+oDevData.eseeid+'--通道号--'+(fileData[1]-1)+'--文件类型--'+fileData[2]+'--设备名--'+oDevData.device_name+'--文件开始时间--'+fileData[3]+'--文件结束时间--'+fileData[4]+'--保存路径--'+path);
		if(oBackup.startBackup(oDevData.address,oDevData.port,oDevData.eseeid,(fileData[1]-1),fileData[2],oDevData.device_name,fileData[3],fileData[4],path) != 0){
			alert(T('File_download_failed',(parseInt(now,10)+1)));
			now++;
			startDownload();
		}
		/*oList = oList.filter(function(index){
			if(index == 0){ 
				var fileData = $(this).data('data');
				
			}
			return index != 0;
		})*/
	}
	function progressCallback(data){
		//console.log('当前第'+(now+1)+'个文件的下载进度为--------'+data.parm+'---------自动抛出进度---------');
		var oWarp = $('#search_result tr').has('input:checked').eq(now);
			oWarp.find('a').one('click',function(){
				backupstop();
				//show('当前第'+now+'个任务已被终止!');
				return;
			})
		var width = (data.parm/100)*oWarp.find('div').width();
			oWarp.find('.progess span').stop(true,true).animate({width:width},1000);
	}
	
	/*function syndownload(){   //同步下载文件状态.
		return;
		var i=0;
		var oWarp = $('#search_result tr').has('input:checked').eq(now);
			oWarp.find('a').one('click',function(){
				backupstop();
				//show('当前第'+now+'个任务已被终止!');
				return;
			})
		timer = setInterval(function(){
			i++;
			var p = oBackup.getProgress();
			var width = p*oWarp.find('div').width();
			oWarp.find('.progess span').stop(true,true).animate({width:width},1000);
			//console.log('当前第'+(now+1)+'个文件的下载进度为--------'+p+'---------手动获取进度---------::所耗时间为'+i+'秒!');
			if(p == 1){
				//clearInterval(timer);
				$('#search_result tr').has('input:checked').eq(now).prop('checked',false).find('span').width(oWarp.find('div').width());
			}
		},1000);
		//show('正在下载当前选中文件的第'+now+'个!');
	}*/

	function BackupStatusChangeCallback(data){
		var oList = $('#search_result input:checked'),
			oWarp = oList.eq(now).parent('td').parent('tr'),
			types = data.types;
		console.log('当前第'+(now+1)+'/'+oList.length+'下载文件状态:'+data.types+'----------------------');
		/*if(types == 'startBackup'){
			syndownload();
		}else{*/

			if(types == 'backupFinished'){ 
				console.log('=================当前下载的第'+(now+1)+'个文件下载成功==========================');
				oWarp.find('.progess span').css('width','100%');
				     //.end().find('input').prop('checked',false);
			}

			if(types=='insufficient-disk'){
				backupstop();
				oList.prop('checked',false);
				alert(lang.Insufficient_Disk_Space);
				return;
			}

			if( types == 'fail'){
				console.log('=================当前下载的第'+(now+1)+'个文件下载失败==========================');
				oWarp.find('.progess').find('span').css('background-color','#ccc')
									  .end().find('div').css('border-style','dashed');	
			}
			if( types == 'stopBackup'){
				console.log('=================当前下载的第'+(now+1)+'个文件下载停止==========================');
				//clearInterval(timer);
				now++;
				if(now == oList.length){
					backupstop();
					return;
				}
				oWarp.find('a').off();
				startDownload();
			}
		/*}*/
	}

	function backupstop(){
		console.log('所有选择的文件下载完成!!!');
		oBackup.stopBackup();
		now=0;
		$('#search_result input:checked').prop('checked',false);
		//clearInterval(timer);
	}

	function backupSearchFile(){
		//console.log('~~~~~~~~~~~~~~~~~~~~当前搜索状态:'+searchSTOP+'~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~');
		if(searchSTOP){
			searchSTOP = 0;
		}else{
			//console.log('当前搜索状态:'+searchSTOP+'------------------------正在搜索');
			return;
		}
		$('#file_warp').removeAttr('b');
		usedUid = [];
		recFile=[];
		nowPage=-1;
		$('#page').html('');
		console.log('++++++++开始搜索+++++++++++');
		var obj =$('#search_resultFile tr');
		if(obj.length != 0){
			obj.filter(function(){
				return !$(this).find(':checkbox').is(':checked');
			}).remove();//远程备份中正在下载的文件不被删除.

			/*obj.has(':checked').each(function(){
				usedUid.push($(this).attr('uid'));
			})*/
		}
		ocxsearchVideo();
	}

	function initOxcDevListStatus(){
		areaList2Ui(1);

		$('div.dev_list span.device').each(function(){
			$(this).parent('li').on({
				dblclick:function(){
					backupSearchFile();
				},
				click:function(){
					$('div.dev_list li').removeClass('sel');
					$(this).addClass('sel');
				}
			})
		})


		contentMax();

		initrecFileOcx($('#search_resultFile tr').filter(function(){return $(this).find(':checkbox').not('checked')}));
	}

	function selectAll(){
		var oCheckbox = $('#search_resultFile :checkbox');

		var b = true;
		oCheckbox.each(function(){
			if(!$(this).is(':checked')){
				b = true;
			}else{
				b = false;
			}

		})
		oCheckbox.prop('checked',b);
	}

	function selectPage(num,oSel){
		$(oSel).addClass('sel').siblings('span').removeClass('sel');
		var obj =$('#search_resultFile tr');
		if(obj.length != 0){
			obj.filter(function(){
				return !$(this).find(':checkbox').is(':checked');
			}).remove();//远程备份中正在下载的文件不被删除.

			obj.has(':checked').each(function(){
				usedUid.push($(this).attr('uid'));
			})
		}
		usedUid = unique(usedUid);
		/*console.log('----------------重新选择的页数:'+num+'--------------------------');
		console.log(usedUid);*/
		nowPage=num;
		reSort_2UI('ChlAsc');
	}
	function unique(arr){ 
		var str = []; 
		for(var i = 0,len = arr.length;i < len;i++){ 
			!RegExp(arr[i],'g').test(str.join(",")) && (str.push(arr[i])); 
		} 
		return str; 
	} 
</script>
<script type="text/javascript" src="js/searchPlayBackFile.js"></script>
</body>
</html>